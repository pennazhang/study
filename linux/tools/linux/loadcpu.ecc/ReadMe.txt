
1. Description: 
	fix the bug that loadcpu can not run at linux with multi-CPU.

2. Compile:

	gcc -c loadcpu.c 
	gcc -o loadcpu loadcpu.o -lpthread

	
3. Run:

	Here is an example runs at ATCA7360 with 16 cores.

root@localhost:/home/ec7987# ./loadcpu 80
Period : 1 second, Time: 10000000
           cpu 0                cpu 1                cpu 2                cpu 3                cpu 4                cpu 5                cpu 6                cpu 7                cpu 8                cpu 9                cpu10                cpu11                cpu12                cpu13                cpu14                cpu15        
    user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle |
  1   3   77    0   20 |   3   77    0   20 |   1   78    0   21 |   2   78    0   20 |   3   74    0   22 |   2   77    0   21 |   3   76    0   20 |   2   78    0   20 |   4   75    0   19 |   3   76    0   19 |   2   78    0   20 |   3   76    0   19 |   3   76    0   21 |   4   75    0   21 |   3   77    0   20 |   1   77    0   20 |
  2   1   78    0   19 |   3   77    0   20 |   2   77    0   19 |   1   78    0   20 |   2   78    0   20 |   2   78    0   20 |   2   77    0   19 |   2   77    0   20 |   2   78    0   20 |   2   77    0   20 |   2   77    0   19 |   2   78    0   20 |   2   77    0   19 |   1   78    0   19 |   4   76    0   20 |   4   76    0   20 |
  3   0   79    0   20 |   3   76    0   20 |   3   76    0   20 |   2   77    0   19 |   2   78    0   20 |   4   76    0   20 |   3   77    0   20 |   3   77    0   20 |   4   76    0   20 |   2   78    0   20 |   4   76    0   20 |   0   80    0   20 |   2   78    0   20 |   2   78    0   20 |   1   78    0   19 |   4   76    0   20 |
  4   3   75    0   20 |   1   79    0   20 |   2   77    0   19 |   1   78    0   20 |   3   76    0   19 |   1   79    0   20 |   3   76    0   21 |   2   77    0   19 |   2   78    0   20 |   2   78    0   20 |   2   78    0   20 |   2   77    0   21 |   1   79    0   20 |   3   77    0   20 |   4   76    0   20 |   4   76    0   20 |
  5   2   77    0   20 |   2   78    0   20 |   2   77    0   20 |   1   79    0   20 |   2   78    0   20 |   1   78    0   20 |   3   77    0   20 |   3   76    0   20 |   3   76    0   20 |   2   78    0   20 |   1   78    0   21 |   1   78    0   19 |   1   78    0   20 |   3   76    0   20 |   3   75    0   20 |   2   78    0   20 |
  6   0   80    0   20 |   5   75    0   20 |   0   79    0   19 |   3   76    0   19 |   4   75    0   20 |   3   76    0   19 |   3   77    0   20 |   1   79    0   20 |   2   77    0   19 |   2   77    0   20 |   2   78    0   20 |   2   78    0   20 |   4   75    0   19 |   3   77    0   20 |   2   78    0   20 |   1   78    0   20 |
  7   2   77    0   19 |   1   77    0   20 |   3   76    0   20 |   2   77    0   20 |   2   78    0   20 |   1   79    0   20 |   4   76    0   20 |   3   77    0   20 |   1   78    0   20 |   0   78    0   20 |   4   76    0   20 |   2   77    0   20 |   1   78    0   20 |   1   79    0   20 |   2   78    0   20 |   2   77    0   19 |
  8   4   75    0   20 |   2   78    0   20 |   1   78    0   19 |   1   79    0   20 |   4   76    0   20 |   3   77    0   20 |   2   78    0   20 |   3   77    0   20 |   3   77    0   20 |   2   78    0   20 |   2   78    0   20 |   2   78    0   20 |   2   78    0   20 |   2   78    0   20 |   1   78    0   20 |   2   77    0   21 |
  9   3   76    0   19 |   0   79    0   19 |   2   78    0   20 |   2   77    0   19 |   4   76    0   20 |   2   77    0   20 |   2   78    0   20 |   1   78    0   19 |   3   76    0   19 |   2   78    0   20 |   3   77    0   20 |   1   79    0   20 |   3   77    0   20 |   3   77    0   20 |   2   78    0   20 |   4   76    0   20 |
 10   3   77    0   20 |   3   76    0   20 |   4   76    0   20 |   0   80    0   20 |   2   76    0   20 |   1   77    0   20 |   3   76    0   20 |   2   77    0   20 |   3   76    0   20 |   1   78    0   20 |   3   77    0   20 |   3   77    0   20 |   1   79    0   20 |   3   77    0   20 |   2   78    0   20 |   2   78    0   20 |
 11   2   77    0   20 |   2   77    0   19 |   1   79    0   20 |   1   77    0   20 |   3   77    0   20 |   2   77    0   20 |   2   77    0   19 |   2   77    0   19 |   3   77    0   20 |   1   78    0   19 |   2   78    0   20 |   4   76    0   20 |   1   77    0   20 |   2   78    0   20 |   1   78    0   21 |   3   77    0   20 |
 12   3   75    0   20 |   2   78    0   20 |   2   77    0   20 |   2   78    0   20 |   2   78    0   20 |   4   75    0   19 |   0   79    0   20 |   4   76    0   20 |   2   76    0   20 |   2   78    0   20 |   3   77    0   20 |   1   77    0   20 |   0   79    0   20 |   3   77    0   20 |   3   76    0   19 |   3   76    0   20 |
 13   2   78    0   20 |   2   77    0   20 |   2   77    0   19 |   0   79    0   20 |   2   78    0   20 |   2   77    0   20 |   2   76    0   20 |   1   77    0   20 |   4   76    0   20 |   2   75    0   23 |   1   78    0   19 |   1   79    0   20 |   2   77    0   19 |   1   78    0   19 |   1   79    0   20 |   1   78    0   19 |
 14   3   77    0   20 |   2   78    0   20 |   1   78    0   20 |   5   75    0   20 |   5   75    0   20 |   3   76    0   19 |   3   77    0   20 |   3   76    0   20 |   2   78    0   20 |   4   76    0   20 |   3   76    0   20 |   1   79    0   20 |   1   79    0   20 |   2   78    0   20 |   2   77    0   20 |   2   77    0   20 |
^C
root@localhost:/home/ec7987# 
root@localhost:/home/ec7987# ./loadcpu 35
Period : 1 second, Time: 10000000
           cpu 0                cpu 1                cpu 2                cpu 3                cpu 4                cpu 5                cpu 6                cpu 7                cpu 8                cpu 9                cpu10                cpu11                cpu12                cpu13                cpu14                cpu15        
    user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle | user sys nice idle |
  1   1   34    0   64 |   1   35    0   64 |   1   34    0   64 |   1   34    0   64 |   1   34    0   65 |   2   33    0   65 |   1   33    0   66 |   1   33    0   66 |   1   33    0   66 |   1   34    0   65 |   0   31    0   68 |   1   32    0   67 |   1   33    0   65 |   1   33    0   66 |   1   33    0   66 |   0   34    0   65 |
  2   1   34    0   63 |   3   33    0   64 |   0   29    0   70 |   1   34    0   63 |   1   33    0   66 |   1   32    0   65 |   3   35    0   62 |   1   32    0   65 |   1   34    0   64 |   2   34    0   64 |   2   34    0   64 |   0   35    0   63 |   0   34    0   65 |   0   34    0   65 |   0   33    0   65 |   2   31    0   65 |
  3   1   31    0   67 |   2   31    0   66 |   0    0    0  100 |   0   35    0   65 |   5   51    0   42 |   1   33    0   65 |   1   31    0   68 |   2   34    0   64 |   2   32    0   66 |   2   32    0   66 |   1   35    0   64 |   2   34    0   64 |   1   34    0   65 |   0   34    0   64 |   1   35    0   64 |   2   34    0   64 |
  4   2   32    0   66 |   0   32    0   66 |   0    0    0  100 |   0   32    0   67 |   6   62    0   31 |   1   34    0   65 |   2   31    0   67 |   1   32    0   66 |   0   32    0   67 |   0   31    0   68 |   2   34    0   64 |   1   34    0   65 |   2   30    0   67 |   0   32    0   68 |   0   33    0   66 |   0   34    0   65 |
  5   0   35    0   63 |   2   34    0   64 |   0    0    0  100 |   2   34    0   64 |   5   53    0   40 |   2   34    0   64 |   3   33    0   64 |   1   35    0   64 |   0   36    0   64 |   2   31    0   67 |   3   29    0   68 |   1   30    0   68 |   0   36    0   64 |   2   32    0   65 |   1   32    0   65 |   0   32    0   67 |
  6   1   34    0   64 |   1   35    0   64 |   0    0    0  100 |   3   33    0   64 |   6   63    0   31 |   0   32    0   67 |   0   33    0   67 |   0   30    0   68 |   1   35    0   64 |   3   30    0   67 |   1   32    0   67 |   0   31    0   67 |   1   34    0   65 |   1   31    0   68 |   1   31    0   68 |   1   33    0   64 |
  7   0   35    0   63 |   1   35    0   64 |   0    0    0  100 |   0   32    0   66 |   6   60    0   34 |   0   35    0   63 |   0   35    0   65 |   2   33    0   64 |   1   35    0   64 |   4   31    0   65 |   2   33    0   63 |   1   33    0   65 |   0   33    0   66 |   0   34    0   64 |   1   31    0   68 |   2   34    0   64 |
  8   0   36    0   64 |   1   34    0   63 |   0    2    0   97 |   0   34    0   66 |   5   65    0   29 |   0   36    0   64 |   2   34    0   64 |   1   35    0   64 |   1   35    0   64 |   3   32    0   63 |   2   33    0   64 |   0   36    0   64 |   1   35    0   64 |   2   34    0   64 |   2   33    0   64 |   1   34    0   64 |
  9   2   34    0   64 |   2   31    0   66 |   0    0    0  100 |   1   35    0   64 |   5   66    0   27 |   1   32    0   67 |   2   33    0   65 |   2   31    0   67 |   1   35    0   64 |   3   31    0   65 |   1   31    0   66 |   1   34    0   63 |   2   34    0   64 |   0   36    0   64 |   1   35    0   64 |   1   35    0   64 |
 10   2   32    0   66 |   0   31    0   67 |   0    0    0  100 |   0   34    0   64 |   7   65    0   28 |   1   33    0   64 |   1   33    0   66 |   1   34    0   63 |   1   31    0   67 |   2   31    0   67 |   3   32    0   64 |   1   34    0   64 |   3   29    0   68 |   1   32    0   67 |   1   33    0   66 |   1   34    0   63 |
 11   0   35    0   65 |   3   32    0   65 |   0    0    0  100 |   1   33    0   65 |   7   62    0   30 |   0   36    0   64 |   2   34    0   64 |   3   33    0   64 |   1   31    0   66 |   3   33    0   62 |   2   33    0   63 |   1   33    0   66 |   1   35    0   64 |   1   34    0   65 |   1   32    0   65 |   1   32    0   66 |
 12   2   33    0   65 |   1   34    0   64 |   0    0    0  100 |   2   34    0   64 |   6   66    0   28 |   0   34    0   65 |   1   34    0   64 |   1   30    0   68 |   1   35    0   64 |   4   31    0   64 |   1   33    0   66 |   0   34    0   64 |   1   35    0   64 |   2   34    0   64 |   0   36    0   64 |   1   30    0   68 |
^C
root@localhost:/home/ec7987# 